---
layout: post
title: 脚本收集
categories: [脚本]
tags: [脚本, shell]

excerpt: 记录一些常用的脚本，供日常工作参考
---
# 基础概念
## 执行字符串
~~~
cat `which cat` # `which pwd` 会被单做一个命令执行，然后执行的结果作为参数给cat
~~~


# 工具包
## coreutils
[coreutils](http://www.gnu.org/software/coreutils/coreutils.html)是GNU操作系统的基础文件操作，文本处理及通用shell脚本工具包, 由Fileutils, textutils, sh-utils合并而来。

所有gnu 软件在mac下面以g打头，如gawk, gsed
# 文件操作

~~~shell
ack "hello" # 遍历当前目录及子目录下所有含字符串"hello"的文件
grep "hello" * #当前目录下所有文件里面查找字符串'hello', 比ack慢

find . -name "*.c" 在当前目录及其子目录（用“.”表示）中查找任何扩展名为“c”的文件

ls **      #递归查找所有的子目录, **是一个通用的递归搜索符号
vim /main/gj **/*.js  #在vim下递归查找所有js文件，找出main函数所在
~~~

~~~
split -b 200000 big.txt # 拆分文件,按每个文件200000byte大小拆分

~~~
## 参考
[Vimer的世界](http://easwy.com/blog/archives/advanced-vim-skills-catalog/)

# 进程、端口、文件句柄管理

## 进程管理

1. 打印所有进程,
~~~
ps -ef  # 打印所有进程
ps -aux # 打印所有进程, mac不支持
~~~

两条命令差不多, `ps -aux`在mac上不能用,[参考](http://www.cnblogs.com/5201351/p/4206461.html)

## lsof, 文件句柄、端口号管理

~~~shell
lsof /data/
lsof +D /var/log/
lsof -c ssh -c init  #列出被指定进程名打开的文件, -c 指command
lsof -i:22          #查看指定端口有哪些进程在使用
lsof -i -a -p 234   #查看进程234打开的所有网络文件
lsof -i -a -c ssh  #查看进程ssh打开的所有网络文件
lsof -i tcp        #查看所有tcp连接
lsof -i udp        #查看所有udp连接
lsof -i@192.168.1.191   #查看指定网口有哪些进程在使用
lsof -u messagebus     #查看指定用户打开的文件
~~~

# 参考
[linux系统监控、诊断工具之lsof](https://my.oschina.net/leejun2005/blog/153584)
