---
layout: post
title: Gradle入门
tags:
- Gradle

categories:
- 技术
- Android

excerpt: 本文记录一些gradle相关的东西, 都是一些碎片性的东西，没有啥可读性，请自行跳过。
---
本文希望能通过利用gradle实现一个趣味的功能来带领大家入门gradle. 主要内容包括:

1. 简单的Hello World
1. 利用gradle实现清理磁盘的功能


代码会放到github上面去。

# 功能片段
## 修改文件内容
使用ant来替换文件中的内容:

~~~Groovy
task replaceReactDependency {
    ant.replaceregexp(match:"compile.*react-native.*", replace:"compile project(':ReactAndroid')", flags:'g', byline:true) {
        fileset(dir: '../../node_modules/react-native-fetch-blob/android', includes: 'build.gradle')
    }
}
~~~
# gradle命令行

```Groovy
./gradlew clean # 清除build目录下面的内容
./gradlew assembleDebug 编译并打Debug包
./gradlew build 检查依赖并编译打包
       这里注意的是 ./gradlew build 命令把 debug、release 环境的包都打出来，如果正式发布只需要打 Release 的包，该怎么办呢，下面介绍一个很有用的命令 assemble , 如
./gradlew assembleRelease 编译并打Release的包

gradle aR 等同于gradle assembleRelease 等同于gradle assR, 这是驼峰命名简称。只要没有其它命令匹配 aR就能工作
```

# 有意思的doLast, doFirst

<< 是doLast的alias，

```Groovy
task myTask

myTask << {
    println "myTask main execution block"
}

myTask.doFirst {
println "myTask doFirst call one"
}

myTask.doFirst {
    println "myTask doFirst call two"
}

myTask.doLast {
    println "myTask doLast"
}

myTask << {
    println "myTask more main execution block"
}
```

输出

```
:myTask
myTask doFirst call two
myTask doFirst call one
myTask main execution block
myTask doLast
myTask more main execution block

BUILD SUCCESSFUL
```

参考 [stackoverflow gradle doLast philosophy](http://stackoverflow.com/questions/13503489/gradle-dolast-philosophy)

# 调试gradle
## print
##

# Gradle插件

# 参考
启动gradle gui

```java
gradle --gui

gradle --gui& // 后台启动gradle，不阻塞命令行
gradle assembleDebug --profile // 查看什么地方会有十分耗时的任务来针对性的优化。
```

在gradle中使用[ant](https://docs.gradle.org/current/userguide/ant.html)

[gradle 命令行黑魔法](http://www.huangbowen.net/blog/2013/09/01/command-line-of-gradle/), 命令行的一些使用细节讲得非常好。

[grandle给安卓做多渠道打包](http://stormzhang.com/devtools/2015/01/15/android-studio-tutorial6/)
[Gradle初学者](http://stormzhang.com/android/2016/07/02/gradle-for-android-beginners/)

[debug gradle on android studio](http://galenlin.github.io/en/android/2016/01/29/debug-gradle-on-android-studio.html)

[Gradle for android 中文文档](https://chaosleong.gitbooks.io/gradle-for-android/content/introduction/index.html), gitbooks.io上开源免费的，讲解很系统。

[gradle java plugin 文档](https://docs.gradle.org/current/userguide/java_plugin.html), 可以查看默认有哪些task，有哪些变量，哪些
